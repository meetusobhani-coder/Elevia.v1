<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Elevia ‚Äî Calculator</title>
<link rel="stylesheet" href="style.css">
<style>
body { font-family: 'Poppins', sans-serif; background:#f3f5f9; margin:0; padding:0; }
.site-header { display:flex; justify-content:space-between; align-items:center; padding:10px 20px; background:#fff; box-shadow:0 2px 5px rgba(0,0,0,0.1);}
.site-title { font-size:24px; }
.signout-btn, .admin-btn { border:none; padding:5px 10px; border-radius:5px; cursor:pointer; margin-left:10px; font-size:14px; }
.signout-btn { background:#22c55e; color:#fff; }
.admin-btn { background:#ff6b6b; color:#fff; }
.main-center { max-width:800px; margin:20px auto; padding:0 20px; }
.calculator-wrap { background:#fff; padding:20px; border-radius:10px; box-shadow:0 2px 10px rgba(0,0,0,0.1); }
.calc-form label { display:block; margin-bottom:15px; font-weight:500; }
.calc-form select { width:100%; padding:8px; margin-top:5px; border-radius:5px; border:1px solid #ccc; }
.buttons-row { display:flex; gap:10px; margin-top:15px; flex-wrap:wrap; justify-content:center; }
.buttons-row button, .buttons-row a { padding:10px 15px; border:none; border-radius:5px; cursor:pointer; background:#4f46e5; color:#fff; text-decoration:none; text-align:center; }
.buttons-row .reset { background:#6b7280; }
.buttons-row .link { background:#fff; color:#4f46e5; border:1px solid #e6e9f2; }
#result { margin-top:20px; padding:15px; background:#f0f4ff; border-radius:5px; display:none; }
#consultingPopup { margin-top:15px; padding:15px; background:#fff0f5; border-radius:8px; display:none; text-align:center; }
.download-btn { margin-top:10px; padding:8px 12px; background:#4f46e5; color:#fff; border:none; border-radius:5px; cursor:pointer; text-decoration:none; display:inline-block; }
#adminPopup { display:none; position:fixed; top:10%; left:50%; transform:translateX(-50%); background:#fff; padding:20px; border-radius:10px; box-shadow:0 2px 10px rgba(0,0,0,0.3); max-width:90%; max-height:80%; overflow:auto; z-index:1000; }
#adminPopup table { width:100%; border-collapse:collapse; margin-top:10px; }
#adminPopup th, #adminPopup td { border:1px solid #ccc; padding:8px; text-align:center; }
#adminPopup button { margin-top:10px; background:#ff6b6b; color:#fff; padding:5px 10px; border:none; border-radius:5px; cursor:pointer; }
.popup-input { width:90%; padding:8px; margin:8px 0; border-radius:5px; border:1px solid #ccc; }
.popup-btn { padding:10px 15px; margin-top:10px; border:none; border-radius:5px; cursor:pointer; background:#4f46e5; color:#fff; width:95%; }
.popup-overlay { position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,0.5); display:flex; justify-content:center; align-items:center; z-index:999; }
.popup-box { background:#fff; padding:20px; border-radius:10px; max-width:400px; width:90%; text-align:center; }
.signup-link { color:#4f46e5; cursor:pointer; margin-top:10px; display:block; }
.small-muted { font-size:0.9rem; color:#6b7280; }
</style>
</head>
<body>

<!-- Sign In Popup -->
<div id="signin-popup" class="popup-overlay" style="display:none;">
  <div class="popup-box">
    <h2>Welcome to Elevia ‚ú®</h2>
    <p class="small-muted">Sign in or sign up to continue your journey</p>
    <input type="email" id="email" placeholder="Enter your email" class="popup-input" />
    <input type="password" id="password" placeholder="Enter your password" class="popup-input" />
    <button onclick="signin()" class="popup-btn">Sign In</button>
    <p class="signup-link" onclick="showSignup()">New here? Create an account</p>
  </div>
</div>

<!-- Signup Popup -->
<div id="signup-popup" class="popup-overlay" style="display:none;">
  <div class="popup-box">
    <h2>Create Your Account üå±</h2>
    <input type="text" id="signup-name" placeholder="Full Name" class="popup-input" />
    <input type="email" id="signup-email" placeholder="Email" class="popup-input" />
    <input type="password" id="signup-password" placeholder="Password" class="popup-input" />
    <button onclick="signup()" class="popup-btn">Sign Up</button>
    <p class="signup-link" onclick="showSignin()">Already have an account? Sign in</p>
  </div>
</div>

<header class="site-header">
  <h1 class="site-title">Elevia</h1>
  <div>
    <button id="signoutBtn" class="signout-btn" style="display:none;">Sign Out</button>
    <button id="adminBtn" class="admin-btn" style="display:none;">Admin View</button>
  </div>
</header>

<main class="main-center">
<section class="calculator-wrap">
  <h2 class="calc-intro">Discover your readiness to manifest your desires!</h2>

  <form id="manifestationForm" class="calc-form" onsubmit="return false;">
    <label>‚ú® Intention
      <select id="intention">
        <option value="">‚Äî Select intention ‚Äî</option>
        <option value="Love">Love</option><option value="Career">Career</option><option value="Family">Family</option>
        <option value="Health">Health</option><option value="Wealth">Wealth</option><option value="Self">Self-Growth</option>
      </select>
    </label>
   <label>‚è≥ Timing Readiness (1‚Äì10)
        <select id="timing">
          <option value="">‚Äî Select 1‚Äì10 ‚Äî</option>
          <option value="1">1 (Low)</option><option value="2">2</option><option value="3">3</option>
          <option value="4">4</option><option value="5">5</option><option value="6">6</option>
          <option value="7">7</option><option value="8">8</option><option value="9">9</option>
          <option value="10">10 (High)</option>
        </select>
        <small>Is now the right time for this wish?</small>
      </label>

        <label>üèÉ Action Alignment (1‚Äì10)
        <select id="action">
          <option value="">‚Äî Select 1‚Äì10 ‚Äî</option>
          <option value="1">1 (Low)</option><option value="2">2</option><option value="3">3</option>
          <option value="4">4</option><option value="5">5</option><option value="6">6</option>
          <option value="7">7</option><option value="8">8</option><option value="9">9</option>
          <option value="10">10 (High)</option>
        </select>
        <small>Are your actions aligned with your wish?</small>
      </label>

     <label>üéØ Milestone Clarity (1‚Äì10)
        <select id="clarity">
          <option value="">‚Äî Select 1‚Äì10 ‚Äî</option>
          <option value="1">1 (Low)</option><option value="2">2</option><option value="3">3</option>
          <option value="4">4</option><option value="5">5</option><option value="6">6</option>
          <option value="7">7</option><option value="8">8</option><option value="9">9</option>
          <option value="10">10 (High)</option>
        </select>
        <small>How clear is your goal?</small>
      </label>

    <label>üåà Patience Level
      <select id="patience">
        <option value="">‚Äî Select ‚Äî</option>
        <option>Low</option><option>Medium</option><option>High</option>
      </select>
    </label>
    <label>‚ù§Ô∏è Emotional Energy (¬∞)
      <select id="phi">
        <option value="">‚Äî Select ‚Äî</option>
        <option value="0">0¬∞</option><option value="180">180¬∞</option><option value="360">360¬∞</option>
      </select>
    </label>

    <div class="buttons-row">
      <button type="button" id="calculateBtn">Calculate</button>
      <button type="button" id="resetBtn" class="reset">Reset</button>
    </div>

    <div class="buttons-row">
      <a href="index.html" class="link">üè† Back to Home</a>
      <a href="details.html" class="link">üåü Go to Consulting</a>
    </div>
  </form>

  <div id="result"></div>
  <div id="consultingPopup">
    <h3>Need deeper clarity? Explore our consulting section.</h3>
    <a href="details.html" class="download-btn">Go to Consulting</a>
  </div>
</section>
</main>

<!-- Admin Popup -->
<div id="adminPopup">
  <h3>All Stored Manifestation Data</h3>
  <table>
    <thead>
      <tr><th>Name</th><th>Email</th><th>Intention</th><th>Score</th><th>Strengths</th><th>Improvements</th><th>Date</th></tr>
    </thead>
    <tbody id="adminTableBody"></tbody>
  </table>
  <div style="display:flex;gap:10px;margin-top:10px;">
    <button id="downloadBtn" class="admin-btn">Download XLSX</button>
    <button id="resetAllBtn" class="admin-btn" style="background:#7c3aed;">Reset All Data</button>
    <button onclick="closeAdmin()">Close</button>
  </div>
</div>

<footer class="site-footer">
  <p>¬© 2025 Elevia</p>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
const ADMIN_EMAIL = "admin@elevia.com";
const signinPopup=document.getElementById('signin-popup');
const signupPopup=document.getElementById('signup-popup');
const signoutBtn=document.getElementById('signoutBtn');
const adminBtn=document.getElementById('adminBtn');
const resultDiv=document.getElementById('result');
const consultingPopup=document.getElementById('consultingPopup');

// show/hide
function showSignup(){ signinPopup.style.display='none'; signupPopup.style.display='flex'; }
function showSignin(){ signupPopup.style.display='none'; signinPopup.style.display='flex'; }

// sign up
function signup(){
  const name=document.getElementById('signup-name').value.trim();
  const email=document.getElementById('signup-email').value.trim();
  const password=document.getElementById('signup-password').value.trim();
  if(!name||!email||!password){ alert("Please fill all fields"); return; }
  let users=JSON.parse(localStorage.getItem('users'))||[];
  if(users.find(u=>u.email===email)){ alert("Email exists"); return; }
  users.push({name,email,password});
  localStorage.setItem('users',JSON.stringify(users));
  sessionStorage.setItem('loggedIn','true');
  sessionStorage.setItem('currentUser',JSON.stringify({name,email}));
  signupPopup.style.display='none'; showUserButtons(email);
}

// sign in
function signin(){
  const email=document.getElementById('email').value.trim();
  const password=document.getElementById('password').value.trim();
  const users=JSON.parse(localStorage.getItem('users'))||[];
  const user=users.find(u=>u.email===email&&u.password===password);
  if(!user){ alert("Incorrect credentials"); return; }
  sessionStorage.setItem('loggedIn','true');
  sessionStorage.setItem('currentUser',JSON.stringify({name:user.name,email:user.email}));
  signinPopup.style.display='none'; showUserButtons(email);
}

// show user buttons
function showUserButtons(email){
  signoutBtn.style.display='inline-block';
  if(email===ADMIN_EMAIL) adminBtn.style.display='inline-block';
}

// sign out
signoutBtn.addEventListener('click',()=>{
  sessionStorage.clear();
  location.reload();
});

// calculate
document.getElementById('calculateBtn').addEventListener('click',()=>{
  const intention=document.getElementById('intention').value;
  const timing=parseInt(document.getElementById('timing').value);
  const action=parseInt(document.getElementById('action').value);
  const clarity=parseInt(document.getElementById('clarity').value);
  const patience=document.getElementById('patience').value;
  const phi=parseInt(document.getElementById('phi').value);
  if(!intention||!timing||!action||!clarity||!patience||isNaN(phi)){ alert("Please fill all fields"); return; }

  const currentUser=JSON.parse(sessionStorage.getItem('currentUser'))||{name:"User",email:""};
  let score=Math.round(((timing+action+clarity)/30*10)*10)/10;
  let strengths=[],improve=[];
  if(timing>=7) strengths.push("Timing"); else improve.push("Timing");
  if(action>=7) strengths.push("Action"); else improve.push("Action");
  if(clarity>=7) strengths.push("Clarity"); else improve.push("Clarity");
  if(patience==="High") strengths.push("Patience"); else improve.push("Patience");
  if(phi===360) strengths.push("Emotional energy"); else improve.push("Emotional energy");
  const msg=`Dear ${currentUser.name},<br>
  ${
    score>=8?`You‚Äôre in a powerful phase to manifest <b>${intention}</b>. Keep going with confidence!`:
    score>=5?`You‚Äôre on track for <b>${intention}</b>. A few steady tweaks in action and clarity will amplify your results.`:
    `This is a reflective time for <b>${intention}</b>. Revisit your vision gently and align your pace with patience.`
  }
  <br><strong>Strengths:</strong> ${strengths.join(", ")}<br>
  <strong>Improvements:</strong> ${improve.join(", ")}`;

  resultDiv.innerHTML=msg;
  resultDiv.style.display='block';
  consultingPopup.style.display='block';

  const data={name:currentUser.name,email:currentUser.email,intention,score,strengths:strengths.join(", "),improvements:improve.join(", "),date:new Date().toLocaleString()};
  const allData=JSON.parse(localStorage.getItem('allCalculations'))||[];
  allData.push(data);
  localStorage.setItem('allCalculations',JSON.stringify(allData));
});

// reset
document.getElementById('resetBtn').addEventListener('click',()=>{
  document.getElementById('manifestationForm').reset();
  resultDiv.style.display='none';
  consultingPopup.style.display='none';
});

// admin view
adminBtn.addEventListener('click',()=>{
  const allData=JSON.parse(localStorage.getItem('allCalculations'))||[];
  const tbody=document.getElementById('adminTableBody');
  tbody.innerHTML='';
  allData.forEach(i=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`<td>${i.name}</td><td>${i.email}</td><td>${i.intention}</td><td>${i.score}</td><td>${i.strengths}</td><td>${i.improvements}</td><td>${i.date}</td>`;
    tbody.appendChild(tr);
  });
  document.getElementById('adminPopup').style.display='block';
});
function closeAdmin(){ document.getElementById('adminPopup').style.display='none'; }

// download
document.getElementById('downloadBtn').addEventListener('click',()=>{
  const allData=JSON.parse(localStorage.getItem('allCalculations'))||[];
  if(!allData.length){ alert("No data"); return; }
  const ws=XLSX.utils.json_to_sheet(allData);
  const wb=XLSX.utils.book_new(); XLSX.utils.book_append_sheet(wb,ws,"Elevia");
  XLSX.writeFile(wb,"Elevia_Data.xlsx");
});

// reset all data
document.getElementById('resetAllBtn').addEventListener('click',()=>{
  if(confirm("Delete all data?")){
    localStorage.removeItem('allCalculations');
    alert("Data cleared");
  }
});

// maintain session (no popup across pages)
window.onload=()=>{
  const sessionUser=JSON.parse(sessionStorage.getItem('currentUser'));
  if(sessionUser){
    showUserButtons(sessionUser.email);
  }else signinPopup.style.display='flex';
};
</script>
</body>
</html>
